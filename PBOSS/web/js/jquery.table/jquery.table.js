/** 
 * jQuery Table Plugin
 * version: 1.1.3 beta (Jan. 2010)
 * 1.1.3b - For pboss内网专用（增加个性设定）
 * 1.1.3a - 增加出错自定义函数（succeesFn）--加上Pboss未登录处理[个性]
 * 1.1.2a - 增加调用成功之后回调的函数（succeesFn）
 * @requires jQuery v1.3.2 or later and jquery.form.js
 * @author Jimmy @revenco
 */
var CRLR="\n";(function(C){var E=null;C.fn.queryTable=function(H){this._defaults={debug:false,tableID:"jqTbl",tableClass:"tb_comn",tHeadClass:"",tBodyClass:"",width:"100%",showTable:true,useTH:false,keepShowData:false,getTbaleFn:getTable,getTbodyFn:P,showMsgFn:M,succeesFn:null,pageNo:1,pageSize:10,pageQuery:0};var Q=C.extend({},this._defaults,H);if(Q.debug!=null){C.fn.queryTable.debug=Q.debug}if(!this.length){B("queryTable: skipping process - 没有找到指定的对象");return this}var L=C(this);var O=null;if(!C.isUndefined(Q.navigation)&&Q.navigation.length>0){O=Q.navigation;O.hide()}var I=Q.queryFrom;if(!C.isFunction(Q.getTbaleFn)){Q.getTbaleFn=getTable}if(!C.isFunction(Q.getTbodyFn)){Q.getTbodyFn=P}if(!C.isFunction(Q.showMsgFn)){Q.showMsgFn=M}var K=J;if(C.isFunction(Q.fmtLink)){K=Q.fmtLink}if(C.isString(Q.tableID)&&Q.tableID!=""){C.fn.queryTable.jqTableId=Q.tableID}var F=Q.getTbaleFn(L,Q);N(Q.pageNo,Q.pageSize,Q.pageQuery);function N(S,R,W){if(H.unableBtu){var V=C(H.unableBtu);V.attr("disabled",true)}var Y=I.attr("action");var U="";if(A(S)){U+="param._pageno="+S}if(A(R)){U+=(U!=""?"&":"")+"param._pagesize="+R}if(U!=""){Y+=(Y.indexOf("?")>=0?"&":"?")+U}var X=function(b){if(!b.isSuccess){Q.showMsgFn(b.message,F,b.retCode);if(H.unableBtu){var a=C(H.unableBtu);a.attr("disabled",false)}return}else{var Z=b.datas;Q.getTbodyFn(Z,F,L,b);if(b.page){G(b.page,Q.tableID)}}if(C.isFunction(H.succeesFn)){H.succeesFn(b)}if(H.unableBtu){var a=C(H.unableBtu);a.attr("disabled",false)}};var T={dataType:"json",url:Y,success:X};I.ajaxSubmit(T)}function M(U,S,R){if(Q.keepShowData){if(R==2){alert("未登录或者登录超时!");window.location="/";return}alert(U);if(E!=null){var T=S.find("#jqTblBodyMark tr");T.hide();E.appendTo(S);O.show();return}}var T=S.find("tbody");T.find("td").html(U)}function P(U,S){var R=S.find("#jqTblBodySet tr");var Y=S.find("#jqTblBodyMark tr");var X=S.find("#jqTblBodySet");if(U.length>0){for(var T=0;T<U.length;T++){var W=U[T];var V=R.clone();V.show();V.removeClass();if(Q.tBodyClass&&C.trim(Q.tBodyClass)!=""){V.addClass(Q.tBodyClass)}C("td",V).each(function(a,c){var b=C(c);b.removeAttr("id");b.html("");var Z=b.attr("sId");var e=b.attr("sIndex");var d=W[Z];var f=K(b,W,d,Q.showCols[e],V);b.html(f)});V.attr("id","ready");V.appendTo(X)}Y.hide();X.appendTo(S);if(Q.keepShowData){E=X.clone()}}else{Y.find("td").html("没有数据")}}function G(T,V){if(O!=null){O.empty();var S=C.extend({},C.fn.queryTable.navigator,{});S.changeTextID+="_"+V;S.changeLinkID+="_"+V;S.firstLinkID+="_"+V;S.prevLinkID+="_"+V;S.nextLinkID+="_"+V;S.lastLinkID+="_"+V;var Y="",R="",X="",W="";if(!T.previous){Y="";R=""}else{Y="<a href='javascript:' style='text-decoration:none' id='"+S.firstLinkID+"'><img border='0' src='images/first.gif' alt='第一页' /></a> "+CRLR;R="<a href='javascript:' style='text-decoration:none' id='"+S.prevLinkID+"'><img border='0' src='images/preview.gif' alt='前一页' /></a> "+CRLR}if(!T.next){X="";W=""}else{X="<a href='javascript:' style='text-decoration:none' id='"+S.nextLinkID+"'><img border='0' src='images/next.gif' alt='下一页' /></a>"+CRLR;W="<a href='javascript:' style='text-decoration:none' id='"+S.lastLinkID+"'><img border='0' src='images/last.gif' alt='最后一页' /></a> "+CRLR}var U="";U+=(Y+R);U+=(X+W);U+="总计<font color='red'>"+T.numbers+"</font>页;当前第<font color='red'>"+T.current+"</font>页";U+="&nbsp; 跳转至<input id='"+S.changeTextID+"' name='"+S.changeTextID+"' type='text' size='2' ID='goto_page' value='"+T.current+"'>页<a href='javascript:' style='text-decoration:none'><img src='/images/go.gif' alt='跳转至' width='16' height='14' border='0' id='"+S.changeLinkID+"'></a>";O.html(U);C("#"+S.firstLinkID).click(function(){D(1,T.size,Q,L)});C("#"+S.prevLinkID).click(function(){D(T.current-1,T.size,Q,L)});C("#"+S.nextLinkID).click(function(){D(T.current+1,T.size,Q,L)});C("#"+S.lastLinkID).click(function(){D(T.last,T.size,Q,L)});C("#"+S.changeLinkID).click(function(){var Z=C("#"+S.changeTextID).val();if(!A(Z)){Z=parseInt(Z);D(Z,T.size,Q,L)}else{alert("请输入正确的页码!")}});O.show()}}function J(T,S,U,R){return U}};C.fn.queryTable.debug=true;C.fn.queryTable.jqTableId="jqDateTbl";C.fn.queryTable.navigator={page:"页",first:"首页",last:"尾页",prev:"上页",next:"下页",records:"条记录",page:"页",changeTextID:"jqTxtChgPage",changeLinkID:"jqChangeLink",firstLinkID:"jqFirstLink",prevLinkID:"jqPrevLink",nextLinkID:"jqNextLink",lastLinkID:"jqLastLink"};function B(){if(C.fn.queryTable.debug){if(window.console&&window.console.log){window.console.log("[jquery.queryTable] "+Array.prototype.join.call(arguments,""))}else{alert("[jquery.queryTable] "+Array.prototype.join.call(arguments,""))}}}function D(H,G,I,F){I.pageNo=H;I.pageSize=G;I.pageQuery=1;F.queryTable(I)}function A(F){return typeof F==="number"&&isFinite(F)}})(jQuery);function getTable(H,B){this._defaults={tableClass:"tb_comn",showTable:true,tHeadClass:"",tBodyClass:"",width:"100%",useTH:false};var L=$.extend({},this._defaults,B);var E=0;var I="";var J=L.useTH?"th":"td";var G="";if(L.tableClass&&$.trim(L.tableClass)!=""){I=' class="'+L.tableClass+'"'}else{I=" border='1'"}if(L.width&&L.width!=""){I+=" width='"+L.width+"'"}var K=" <table id='"+H.queryTable.jqTableId+"' "+I+" >"+CRLR;if(L.showTable){K+="<THead>"+CRLR;I="";if(L.tHeadClass&&$.trim(L.tHeadClass)!=""){I=' class="'+L.tHeadClass+'"'}K+="<tr"+I+">"+CRLR;for(var D=0;D<L.showCols.length;D++){if(!L.showCols[D].nonShow){E++;G="";if(L.showCols[D].width!=""){G=" width='"+L.showCols[D].width+"'"}K+="<"+J+" id='jqTblHead"+L.showCols[D].key+"'"+G+">"+L.showCols[D].name+"</"+J+">"+CRLR}}K+="</tr>"+CRLR;K+="</THead>"+CRLR}var A="<TBody id='jqTblBodySet'>"+CRLR;I="";if(L.tBodyClass&&$.trim(L.tBodyClass)!=""){I=' class="'+L.tBodyClass+'"'}A+="<tr"+I+">"+CRLR;for(var D=0;D<L.showCols.length;D++){if(!L.showCols[D].nonShow){G="";if(L.showCols[D].width!=""){G=" width='"+L.showCols[D].width+"'"}A+="<td sId='"+L.showCols[D].key+"' sIndex='"+D+"'"+G+"></td>"}}A+="</tr>"+CRLR;A+="</TBody>"+CRLR;K+=A;K+="<TBody id='jqTblBodyMark'><tr "+I+"><td colspan='"+E+"'>数据加载中...</td></tr></TBody>"+CRLR;K+=" </table>"+CRLR;H.empty();H.append(K);var C=H.find("#"+H.queryTable.jqTableId);var F=C.find("#jqTblBodySet tr");F.hide();return C};