
<html>
	<head>
		<title>选择月份</title>
		<style>
	td {font-family: Tahoma, Verdana, sans-serif; font-size: 12px;}
</style>
		<meta http-equiv="Content-Type" content="text/html; charset=gbk">
		<script language="JavaScript">
var ARR_MONTHS = ["一月", "二月", "三月", "四月", "五月", "六月",
		"七月", "八月", "九月", "十月", "十一月", "十二月"];

var selecDate = window.dialogArguments;
var curDate = new Date();
var year;
var month;

function trim(s) {
	return s.replace(/^\s*/, "").replace(/\s*$/, "");
}

function isValidYYYYMM(date) {
	if (date.length != 6) {
		return false;
	}
	var ma = date.match(/^\d{4}(0[1-9]|1[0-2])$/);
	if (ma) {
		return true;
	}
	return false;
}

function init(){
	if (selecDate){
		if (isValidYYYYMM(selecDate)){
			year = selecDate.substr(0,4);
			month = parseInt(selecDate.substr(4,6) - 1) ;
			
		}else {
			year = new Date().getFullYear();
			month = new Date().getMonth();
		}
	}else {
		year = new Date().getFullYear();
		month = new Date().getMonth();
	}
	
	for(s =1940;s<=2050;s++){
		document.all.selYear.options[document.all.selYear.length] = new Option(s,s); 
	}
	document.all.selYear.value = year;
	document.getElementById("m"+(month + 1)).selected = true;	
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
	document.getElementById("month" + (month+1)).bgColor = "#ffb6c1";
}

function nextYear(){
	year = parseInt(year) + 1;
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
}

function nextMonth(){
	document.getElementById("month" + (month+1)).bgColor = "#dbeaf5";
	month = parseInt(month) +1;
	if (month > 11){
		month = 0;
		year = parseInt(year) + 1;
	}
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
	document.getElementById("month" + (month+1)).bgColor = "#ffb6c1";
}

function preYear(){
	year = parseInt(year) -1;
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
}

function preMonth(){
	document.getElementById("month" + (month+1)).bgColor = "#dbeaf5";
	month = parseInt(month) -1;
	if (month < 0){
		year = parseInt(year) -1;
		month = 11;
	}
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
	document.getElementById("month" + (month+1)).bgColor = "#ffb6c1";
}


function setMoth(sMonth){
	window.returnValue = year + sMonth;
	window.close();
}

function selectYear(sYear){
	year = sYear;
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
}	

function selectMonth(sMonth){
	document.getElementById("month" + (parseInt(month)+1)).bgColor = "#dbeaf5";
	month = parseInt(sMonth -1) ;
	document.getElementById("yearmonth").innerHTML = '<font color="#ffffff">' + ARR_MONTHS[month] + ' '+ year + '</font>';
	document.getElementById("month" + parseInt(sMonth - 0)).bgColor = "#ffb6c1";
}
</script>
	</head>

	<body bgcolor="#dbeaf5" marginheight="3" marginwidth="3" topmargin="2"
		leftmargin="5" rightmargin="5" onload="init()">
		<table class="clsOTable" id="ojbTable" cellspacing="0" border="0" width="100%">
			<tr>
				<td bgcolor="#4682B4">
					<table cellspacing="0" cellpadding="0" border="0" width="100%">
						<tr>
							<td nowrap>
								<span style="cursor:hand"
									onclick="javascript:preYear()"><img
										src="../../images/calendar/prev_year.gif" width="16" height="16"
										border="0" alt="上一年">
								</span>&nbsp;
								<span style="cursor:hand"
									onclick="javascript:preMonth()"><img
										src="../../images/calendar/prev.gif" width="16" height="16"
										border="0" alt="上一月">
								</span>
							</td>
							<td align="center" width="100%" id="yearmonth" colspan=2>
							</td>
							<td nowrap>
								<span style="cursor:hand"
									onclick="javascript:nextMonth()"><img
										src="../../images/calendar/next.gif" width="16" height="16"
										border="0" alt="下一月">
								</span>&nbsp;
								<span style="cursor:hand"
									onclick="javascript:nextYear()"><img
										src="../../images/calendar/next_year.gif" width="16" height="16"
										border="0" alt="下一年">
								</span>
							</td>
						</tr>
					</table>

					<table class="clsOTable" id="ojbTable" cellspacing="0" border="0"
						width="100%">
						<table cellspacing="1" cellpadding="3" border="0" width="100%">
							<tr>
								<td bgcolor="#dbeaf5" align="center" width="24%"  id="month1">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">01</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%"  id="month2">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">02</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%"  id="month3">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">03</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%"  id="month4">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">04</font></span>
								</td>
							</tr>
							<tr>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month5">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));" ><font
										color="#000000">05</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month6">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">06</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month7">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">07</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month8">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">08</font></span>
								</td>
							</tr>
							<tr>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month9">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">09</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month10">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">10</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month11">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">11</font></span>
								</td>
								<td bgcolor="#dbeaf5" align="center" width="24%" id="month12">
									<span style="cursor:hand"
										onclick="javascript:setMoth(trim(this.innerText));"><font
										color="#000000">12</font></span>
								</td>
							</tr>
						</table>
						<tr>
							<td colspan=4 align=center>
								&nbsp;
								<font color="#000000">跳至</font>
								<select name="selYear" onchange="selectYear(this.value)" ID="Select1">
			
								</select>
								<font color="#000000">年</font>
								<select name="selMon" onchange="selectMonth(this.value)" ID="Select2">
									<option id="m1" value="01">
										01
									</option>
									<option id="m2" value="02">
										02
									</option>
									<option id="m3" value="03">
										03
									</option>
									<option id="m4" value="04">
										04
									</option>
									<option id="m5" value="05">
										05
									</option>
									<option id="m6" value="06">
										06
									</option>
									<option id="m7" value="07">
										07
									</option>
									<option id="m8" value="08">
										08
									</option>
									<option id="m9" value="09">
										09
									</option>
									<option id="m10" value="10">
										10
									</option>
									<option id="m11" value="11">
										11
									</option>
									<option id="m12" value="12">
										12
									</option>
								</select>
								<font color="#000000">月</font>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</body>
</html>


