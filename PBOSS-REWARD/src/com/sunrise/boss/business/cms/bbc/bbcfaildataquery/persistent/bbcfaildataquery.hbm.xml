<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
<class name="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" table="V_CH_BBC_SELLFAIL">
<id column="SEQ" name="seq" type="java.lang.Long">
<generator class="sequence">
	<param name="sequence">CH_BBC_SELLFAIL_SEQ</param>
</generator>
</id>
<property column="OPNID" length="18" name="opnid" type="java.lang.String"/>
<property column="NAME" length="50" name="name" type="java.lang.String"/>
<property column="WAYID" length="18" name="wayid" type="java.lang.String"/>
<property column="WAYNAME" length="64" name="wayname" type="java.lang.String"/>
<property column="OPRCODE" length="15" name="oprcode" type="java.lang.String"/>
<property column="OPRTIME" length="7" name="oprtime" type="java.util.Date"/>
<property column="MOBILE" length="15" name="mobile" type="java.lang.String"/>
<property column="CREATTIME" length="7" name="creattime" type="java.util.Date"/>
<property column="CALCMONTH" length="8" name="calcmonth" type="java.lang.String"/>
<property column="RULEID" length="18" name="ruleid" type="java.lang.String"/>
<property column="ADTFLAG" length="2" name="adtflag" type="java.lang.Short"/>
<property column="ADTCODE" length="32" name="adtcode" type="java.lang.String"/>
<property column="ADTREMARK" length="255" name="adtremark" type="java.lang.String"/>
<property column="REWARDTYPE" length="255" name="rewardtype" type="java.lang.String"/>
<property column="OSSRC" length="2" name="ossrc" type="java.lang.Integer" />
<property column="BATCHNO" length="18" name="batchno" type="java.lang.String" />

</class>
<sql-query name="bbcfaildataquery.sellfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	<!-- select * from (select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,(select wayname from CH_PW_WAY w where w.wayid= m.wayid) as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAIL m
	
	union
	
	select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,(select wayname from CH_PW_WAY w where w.wayid= m.wayid) as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAILHIS m) order by calcmonth,opnid,oprtime -->
	select * from (select m.seq,m.calcmonth,m.opnid,'' as name,m.wayid,'' as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAIL m,CH_ADT_ADTCODE a
	where m.adtcode=a.adtcode
	union
	select m.seq,m.calcmonth,m.opnid,'' as name,m.wayid,'' as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,
    '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAILHIS m,CH_ADT_ADTCODE a
	where m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
	
</sql-query>
<sql-query name="bbcfaildataquery.selegflfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno  
	from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webegflfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100fail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100egflfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.adtfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0 order by m.calcmonth,m.opnid,m.oprtime
</sql-query>
<sql-query name="bbcfaildataquery.allfail">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0
	) order by calcmonth,opnid,oprtime
</sql-query>

<sql-query name="bbcfaildataquery.sellfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,(select wayname from CH_BBC_NASWAY w where w.wayid= m.wayid) as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAIL m
	
	union
	
	select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,(select wayname from CH_BBC_NASWAY w where w.wayid= m.wayid) as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAILHIS m) order by calcmonth,opnid,oprtime
	
</sql-query>
<sql-query name="bbcfaildataquery.selegflfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno  
	from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webegflfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100failnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100egflfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.adtfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0 order by m.calcmonth,m.opnid,m.oprtime
</sql-query>
<sql-query name="bbcfaildataquery.allfailnas">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0
	) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.sellfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,
  		CASE
           WHEN OSSRC = 0 THEN
            (select wayname from CH_PW_WAY where wayid = m.wayid)
           WHEN OSSRC = 1 OR OSSRC = 2 THEN
            (select wayname from CH_BBC_NASWAY where wayid = m.wayid)
         END as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAIL m
	
	union
	
	select m.seq,m.calcmonth,m.opnid,
  (select name from CH_BBC_OPERATION c where c.opnid=m.opnid) as name,
  m.wayid,
  		CASE
           WHEN OSSRC = 0 THEN
            (select wayname from CH_PW_WAY where wayid = m.wayid)
           WHEN OSSRC = 1 OR OSSRC = 2 THEN
            (select wayname from CH_BBC_NASWAY where wayid = m.wayid)
         END as wayname,
  m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,
  (select adtremark from CH_ADT_ADTCODE a where a.adtcode= m.adtcode) as adtremark,
  '销售类基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELLFAILHIS m) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.selegflfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode
	
	union
	
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno  
	from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode
	
	union
	
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno  
	from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.webegflfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode
	
	union
	
		select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100failall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode
	
	union
	
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.e100egflfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode
	
	union
	
	select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
	union
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.adtfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	  select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0
	
	union 
	
	select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
	from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
	where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0) order by calcmonth,opnid,oprtime
</sql-query>
<sql-query name="bbcfaildataquery.allfailall">
	<return class="com.sunrise.boss.business.cms.bbc.bbcfaildataquery.persistent.BbcFaildataqueryVO" />
	select * from (
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELLFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'销售类奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_SELEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAIL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBFAILHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'新增网站活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_WEBEGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAIL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户基本酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100FAILHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
		
		union
		
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
			union
			
			select * from (select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFL m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode 
	
			union
	
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'e100活跃客户奖励酬金' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_e100EGFLHIS m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode)
			
		union
		
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_PW_WAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0
			
			union
			
			select m.seq,m.calcmonth,m.opnid,c.name,m.wayid,w.wayname,m.oprcode,m.mobile,m.oprtime,m.createtime as creattime,m.ruleid,m.adtflag,m.adtcode,a.adtremark,'待校验' as rewardtype,m.ossrc,m.batchno
			from CH_BBC_CONTDATA m,CH_BBC_OPERATION c,CH_BBC_NASWAY w,CH_ADT_ADTCODE a
			where m.opnid=c.opnid and m.wayid=w.wayid and m.adtcode=a.adtcode and adtflag=0
	) order by calcmonth,opnid,oprtime
</sql-query>
</hibernate-mapping>
